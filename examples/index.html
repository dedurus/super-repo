
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Repository</title>
</head>

<body>

<script src="../src/index.js"></script>

<button id="invalidate" type="button">Invalidate</button>
<button id="get" type="button">Get</button>
<button id="clear" type="button">Clear</button>
<button id="sync" type="button">Init Syncer</button>
<button id="stopsync" type="button">Stop Syncer</button>

<script>

    const fetctme = () => fetch('weather.json').then(r => r.json());


    const WeatherRepository = new SuperRepo({
        name: 'weather',
        request: fetctme, // Promise!
        dataModel: {
            temperature: 't',
            windspeed: 'w',
            pressure: 'p'
        },
        outOfDateAfter: 5 * 1000 // 5 seconds
    });

    // WeatherRepository.getData().then( r => console.log(r.temperature) );


    document.getElementById('invalidate').addEventListener("click", () => {
        WeatherRepository.invalidateData();
    });
    document.getElementById('get').addEventListener("click", () => {
        WeatherRepository.getData().then( r => console.log(r.temperature) );
    });
    document.getElementById('clear').addEventListener("click", () => {
        WeatherRepository.clearData();
    });

    document.getElementById('sync').addEventListener("click", () => {
        WeatherRepository.initSyncer();
    });
    document.getElementById('stopsync').addEventListener("click", () => {
        WeatherRepository.destroySyncer();
    });

</script>

</body>
</html>
