<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>SuperRepo Example Usage</title>
</head>

<body>

<p>Open the source code and check it out.</p>

<button id="get" type="button">Get data</button>

<button id="invalidate" type="button">Invalidate data</button>
<button id="clear" type="button">Clear (delete) data</button>

<button id="sync" type="button">Init Syncer</button>
<button id="stopsync" type="button">Stop Syncer</button>

<!-- Link to the SuperRepo library -->
<script src="../src/index.js"></script>

<script>

    /**
     * Define a function responsible for getting data from the server.
     * It doesn't matter how, as long as your function returns a Promise.
     */
    const requestWeatherData = () => fetch('weather.json').then(r => r.json());

    // ... or you can use jQuery's $.ajax() (as of v1.5, jQuery implements the Promise interface):
    // const requestWeatherData = () => $.ajax({url:'weather.json'});

    const WeatherRepository = new SuperRepo({
        name: 'weather',
        request: requestWeatherData,
        dataModel: {
            temperature: 't',
            windspeed: 'w',
            pressure: 'p'
        },
        outOfDateAfter: 5 * 1000 // 5 seconds
    });


    document.getElementById('get').addEventListener("click", () => {
        WeatherRepository.getData().then(
            r => console.log(`It is ${r.temperature} degrees.`)
        );
    });

    document.getElementById('invalidate').addEventListener("click", () => {
        WeatherRepository.invalidateData();
    });
    document.getElementById('clear').addEventListener("click", () => {
        WeatherRepository.clearData();
    });

    document.getElementById('sync').addEventListener("click", () => {
        WeatherRepository.initSyncer();
    });
    document.getElementById('stopsync').addEventListener("click", () => {
        WeatherRepository.destroySyncer();
    });

</script>

</body>
</html>
